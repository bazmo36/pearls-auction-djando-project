{% extends "base.html" %}

{% block content %}
    <h1>{{ pearl.name }}</h1>
    <img src="{{ pearl.image.url }}" alt="{{ pearl.name }}" width="200">
    <p>{{ pearl.description }}</p>
    <p>Created at: {{ pearl.created_at }}</p>

    {%if request.user == pearl.owner %}
    <a href="{% url 'pearl_update' pearl.id %}" class="btn">Edit</a>
    <form method='post' action="{% url 'pearl_delete' pearl.pk %}">
        {% csrf_token %}
        <button>Delete</button>
    </form>
    {%endif%}

    {% if request.user == pearl.owner %}
    <a href="{% url 'certification_create' pearl.pk %}" class="btn btn-success">Add Certification</a>
    {% endif %}
 
    {% if pearl.certifications.all %}
    <h2>Certifications</h2>
    {% for cert in pearl.certifications.all %}
        <div class="certification">
          <a href="{% url 'certification_detail' cert.pk %}">
            <img src="{{ cert.certificate_image.url }}" alt="Certificate {{ cert.certificate_number }}" width="200">
        </a>
        </div>
    {% endfor %}
{% endif %}

{% if not pearl.auction %}
  <a href="{% url 'auction_create' pearl.pk %}" >Add to Auction</a>
{% elif pearl.auction.can_modify %}
  <a href="{% url 'auction_update' pearl.auction.pk %}">Edit Auction</a>
  <form method="post" action="{% url 'auction_delete' pearl.auction.pk %}" >
    {% csrf_token %}
    <button>Remove from Auction</button>
  </form>

{% else %}
  <p>This pearl is in an active auction and cannot be changed.</p>
{% endif %}


{% endblock %}
